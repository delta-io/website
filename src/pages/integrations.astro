---
import { Image } from "astro:assets";
import { getCollection } from "astro:content";
import clsx from "clsx";
import Section from "../components/ui/Section.astro";
import Grid from "../components/ui/Grid.astro";
import Tag from "../components/ui/Tag.astro";
import Typography from "../components/ui/Typography.astro";
import Layout from "../layouts/Layout.astro";
import { Logo } from "../components/Logo";
import { UniFormSection } from "../components/Integrations";

const integrations = [
  {
    title: "Frameworks",
    subtitle:
      "Use the following frameworks and languages including but not limited to Apache Flink, Apache Spark, Trino, and Rust.",
    items: await getCollection("integration-connectors"),
  },
  {
    title: "Sharing",
    subtitle:
      "Use the following clients that integrate with Delta Sharing from C++ to Rust.",
    items: await getCollection("integration-sharing"),
  },
  {
    title: "Services",
    subtitle:
      "Use the managed services of your choice that integrate with Delta Lake.",
    items: await getCollection("integration-services"),
  },
  {
    title: "Community",
    subtitle: "Try out the following community integrations with Delta Lake.",
    items: await getCollection("integration-community"),
  },
];
---

<Layout title="Integrations">
  <Section padding="none" className="py-xl bg-white">
    <div class="integrations-hero text-center">
      <Logo loading="eager" />
      <h1 class="integrations-title">Delta Lake Integrations</h1>
      <Typography variant="p" className="integrations-subtitle">
        Use the following frameworks, Delta Sharing clients, managed services,
        and/or community integrations <br /> for Delta Lake and Delta Sharing.
      </Typography>
    </div>
  </Section>
  <UniFormSection />
  {
    integrations.map((integration, i) => (
      <Section
        padding="none"
        className={clsx("py-xxl", {
          "bg-white": i % 2 === 0,
        })}
      >
        <div class="text-center">
          <h2 class="integrations-section-title">{integration.title}</h2>
          <Typography variant="p" className="integrations-section-subtitle">
            {integration.subtitle}
          </Typography>
        </div>
        <Grid columns={{ xs: 1, md: 2, lg: 3 }} className="integrations">
          {integration.items.map(({ data }) => (
            <Typography variant="prose" className="integration">
              <div class="image-container">
                <Image
                  src={data.thumbnail}
                  alt=""
                  height="70"
                  loading="lazy"
                  densities={[1, 2]}
                />
              </div>
              <h4>
                <a href={data.url} target="_blank">
                  {data.name}
                </a>
              </h4>
              <Typography variant="p2" className="integration-links">
                {data.docs !== "" && (
                  <a href={data.docs} target="_blank">
                    docs
                  </a>
                )}
                {data.source_code !== "" && (
                  <a href={data.source_code} target="_blank">
                    source code
                  </a>
                )}
              </Typography>
              {data.tags.length > 0 && (
                <Typography variant="p2" className="integration-tags">
                  {data.tags.map((tag) => (
                    <Tag label={tag} />
                  ))}
                </Typography>
              )}
              <p class="integration-description">{data.description}</p>
            </Typography>
          ))}
        </Grid>
      </Section>
    ))
  }
</Layout>
<style>
  .integrations-hero {
    margin-bottom: var(--spacing-xxl);
  }
  .integrations-title {
    font-size: var(--font-size-h1);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-header);
    margin-bottom: var(--spacing-md);
  }
  .integrations-subtitle {
    max-width: 56rem;
    margin: 0 auto;
  }
  .integrations-section-title {
    font-size: var(--font-size-h2);
    font-weight: var(--font-weight-bold);
    line-height: var(--line-height-header);
    margin-bottom: var(--spacing-md);
  }
  .integrations-section-subtitle {
    max-width: 56rem;
    margin: 0 auto;
    margin-bottom: var(--spacing-xl);
  }
  .integrations {
    column-gap: var(--spacing-lg);
    row-gap: var(--spacing-xl);
  }

  .integration a {
    color: inherit;
    text-decoration: none;
  }

  .integration a:hover {
    text-decoration: underline;
  }

  .image-container {
    width: 70px;
    height: 70px;
    display: flex;
    align-items: flex-end;
  }

  .integration .integration-links {
    margin-bottom: var(--spacing-xs);
  }

  .integration-links {
    color: var(--color-text-secondary);
  }

  .integration-links a + a:before {
    content: "|";
    margin-left: var(--spacing-xs);
    margin-right: var(--spacing-xs);
  }

  .integration-tags {
    display: flex;
    gap: var(--spacing-sm);
  }

  .integration .integration-description {
    font-size: var(--font-size-secondary);
  }
</style>
